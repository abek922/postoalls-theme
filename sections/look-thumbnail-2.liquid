<style>
  .look-section {
    padding: 2rem 0;
  }

  .look-section .section-header {
    text-align: center;
    margin-bottom: 2rem;
  }

  .look-section .section-header__title {
    font-size: 2rem;
    font-weight: 300;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin: 0;
  }

  .look-section .section-description {
    text-align: center;
    margin-bottom: 3rem;
  }

  .look-section .section-description p {
    margin-bottom: 1rem;
    line-height: 1.6;
  }

  .look-section .top-image {
    margin-bottom: 3rem;
    text-align: center;
  }

  .look-section .top-image img {
    max-width: 100%;
    height: auto;
  }

  .look-list-2024fw.pc {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    margin-bottom: 3rem;
  }

  .look-list-2024fw.sp {
    display: none;
  }

  .look-item {
    position: relative;
  }

  .look-item a {
    display: block;
    text-decoration: none;
  }

  .look-item img {
    width: 100%;
    height: auto;
    transition: transform 0.3s ease;
  }

  .look-item:hover img {
    transform: scale(1.02);
  }

  .look-item .caption {
    margin-top: 1rem;
    font-size: 0.9rem;
    line-height: 1.4;
  }

  .scroll {
    position: relative;
    margin-bottom: 2rem;
  }

  .scroll-images {
    display: flex;
    gap: 1rem;
    overflow-x: auto;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 1rem;
  }

  .scroll-images::-webkit-scrollbar {
    height: 4px;
  }

  .scroll-images::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 2px;
  }

  .scroll-images::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 2px;
  }

  .scroll-images::-webkit-scrollbar-thumb:hover {
    background: #555;
  }

  .scroll-images img {
    flex-shrink: 0;
    width: 250px;
    height: auto;
  }

  .scroll-arrow {
    position: absolute;
    top: 50%;
    right: 1rem;
    transform: translateY(-50%);
    background: rgba(255, 255, 255, 0.9);
    border-radius: 50%;
    padding: 0.5rem;
    transition: opacity 0.3s ease;
  }

  .scroll-arrow.hidden {
    opacity: 0;
    pointer-events: none;
  }

  .scroll-arrow img {
    width: 20px;
    height: 20px;
  }

  .scroll .caption {
    margin-top: 1rem;
    font-size: 0.9rem;
    line-height: 1.4;
  }

  /* モバイル対応 */
  @media screen and (max-width: 768px) {
    .look-section {
      padding: 1rem 0;
    }

    .look-section .section-header__title {
      font-size: 1.5rem;
    }

    .look-list-2024fw.pc {
      display: none;
    }

    .look-list-2024fw.sp {
      display: block;
    }

    .look-list-2024fw.pc {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }

    .scroll-images img {
      width: 200px;
    }
  }

  /* プレースホルダー */
  .icon--placeholder {
    width: 100%;
    height: 300px;
    background: #f5f5f5;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #ccc;
  }
</style>

<div class="look-section color-scheme color-scheme--{{ section.settings.color_scheme.id }}">
  <div class="page-width">
    {%- if section.settings.section_title != blank -%}
      <div class="section-header section-header--small">
        <h2 class="section-header__title">
          {{ section.settings.section_title | escape }}
        </h2>
      </div>
    {%- endif -%}

    {%- if section.settings.section_text_1 != blank or section.settings.section_text_2 != blank -%}
      <div class="section-description">
        {%- if section.settings.section_text_1 != blank -%}
          <p>{{ section.settings.section_text_1 | escape }}</p>
        {%- endif -%}
        {%- if section.settings.section_text_2 != blank -%}
          <p>{{ section.settings.section_text_2 | escape }}</p>
        {%- endif -%}
      </div>
    {%- endif -%}

    {%- if section.settings.top_image != blank -%}
      <div class="top-image">
        {{ section.settings.top_image | image_url: width: 1200 | image_tag: alt: section.settings.top_image_alt, loading: 'lazy' }}
      </div>
    {%- endif -%}

    <div class="look-list-2024fw pc">
      {%- for block in section.blocks -%}
        {%- if block.type == 'image' -%}
          <div class="look-item" {{ block.shopify_attributes }}>
            {%- if block.settings.image != blank -%}
              <a href="{{ block.settings.link | default: '#' }}">
                {{ block.settings.image | image_url: width: 600 | image_tag: class: 'gallery__image', alt: block.settings.image.alt, loading: 'lazy' }}
              </a>
              {%- if block.settings.custom_html != blank -%}
                <div class="caption">
                  {{ block.settings.custom_html }}
                </div>
              {%- endif -%}
            {%- else -%}
              <div class="icon--placeholder">
                <svg width="60" height="60" viewBox="0 0 60 60" fill="none">
                  <rect x="12" y="18" width="36" height="24" rx="2" stroke="currentColor" stroke-width="1.5" fill="none"/>
                  <circle cx="22" cy="26" r="3" stroke="currentColor" stroke-width="1.5" fill="none"/>
                  <path d="m45 35-5-5-8 8-4-4-3 3" stroke="currentColor" stroke-width="1.5" fill="none"/>
                </svg>
              </div>
            {%- endif -%}
          </div>
        {%- endif -%}
      {%- endfor -%}
    </div>

    <div class="look-list-2024fw sp">
      {%- for block in section.blocks -%}
        {%- if block.type == 'scroll' -%}
          <div class="scroll" {{ block.shopify_attributes }}>
            <a href="{{ block.settings.link | default: '#' }}" class="scroll-link">
              <div class="scroll-images">
                {%- for i in (1..4) -%}
                  {%- assign image_key = 'image_' | append: i -%}
                  {%- if block.settings[image_key] != blank -%}
                    {{ block.settings[image_key] | image_url: width: 500 | image_tag: class: 'gallery__image', alt: block.settings[image_key].alt, loading: 'lazy' }}
                  {%- endif -%}
                {%- endfor -%}
              </div>
              
              <div class="scroll-arrow">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="9,18 15,12 9,6"></polyline>
                </svg>
              </div>
            </a>
            
            {%- if block.settings.custom_html != blank -%}
              <div class="caption">
                {{ block.settings.custom_html }}
              </div>
            {%- endif -%}
          </div>
        {%- endif -%}
      {%- endfor -%}
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const scrollContainers = document.querySelectorAll('.scroll');

  scrollContainers.forEach(container => {
    const arrow = container.querySelector('.scroll-arrow');
    const scrollImages = container.querySelector('.scroll-images');
    
    if (!scrollImages || !arrow) return;

    // 初期チェック：矢印が必要かどうかを確認
    const checkScroll = () => {
      if (scrollImages.scrollWidth <= scrollImages.clientWidth) {
        arrow.classList.add('hidden');
      } else if (scrollImages.scrollLeft + scrollImages.clientWidth >= scrollImages.scrollWidth) {
        arrow.classList.add('hidden');
      } else {
        arrow.classList.remove('hidden');
      }
    };

    // ページロード時にスクロール位置をチェック
    checkScroll();

    // スクロールイベントをリッスン
    scrollImages.addEventListener('scroll', checkScroll);

    // ウィンドウリサイズ時にもチェック
    window.addEventListener('resize', checkScroll);
  });
});
</script>

{% schema %}
{
  "name": "Look24FW Thumbnail",
  "class": "shopify-section--look",
  "tag": "section",
  "settings": [
    {
      "type": "paragraph",
      "content": "作成中 24FWのサムネ"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "text",
      "id": "section_title",
      "label": "Heading",
      "default": "Look"
    },
    {
      "type": "text",
      "id": "section_text_1",
      "label": "Description text 1",
      "default": "Showcase your seasonal looks"
    },
    {
      "type": "text",
      "id": "section_text_2",
      "label": "Description text 2"
    },
    {
      "type": "image_picker",
      "id": "top_image",
      "label": "Top image"
    },
    {
      "type": "text",
      "id": "top_image_alt",
      "label": "Top image alt text",
      "info": "Describe the image for accessibility"
    }
  ],
  "max_blocks": 60,
  "blocks": [
    {
      "type": "image",
      "name": "Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Image link"
        },
        {
          "type": "html",
          "id": "custom_html",
          "label": "Caption",
          "default": "<p>Look caption</p>"
        }
      ]
    },
    {
      "type": "scroll",
      "name": "Scroll Images",
      "settings": [
        {
          "type": "image_picker",
          "id": "image_1",
          "label": "Image 1"
        },
        {
          "type": "image_picker",
          "id": "image_2",
          "label": "Image 2"
        },
        {
          "type": "image_picker",
          "id": "image_3",
          "label": "Image 3"
        },
        {
          "type": "image_picker",
          "id": "image_4",
          "label": "Image 4"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link URL"
        },
        {
          "type": "html",
          "id": "custom_html",
          "label": "Caption",
          "default": "<p>Scroll look caption</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Look Gallery",
      "category": "POST O'ALLS Look",
      "settings": {
        "section_title": "Latest Looks",
        "section_text_1": "Discover our seasonal collection"
      },
      "blocks": [
        {
          "type": "image",
          "settings": {
            "custom_html": "<p>Sample look</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}